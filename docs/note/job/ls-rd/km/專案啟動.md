#km 

### 專案版本

```shell
node 8.9.4
```

### 安裝套件

此專案是使用 `yarn` 作為套件管理，所以使用

```shell
yarn install
```

### 啟動專案

1.在本地 ngnix 資料夾加入此專案的 ngnix 配置

> 通常 nginx 配置的本地路由為：`usr/local/nginx/config/ngnix.config`

```nginx
server {  
    ### server port and name ###  
    listen          80;  
    server_name     [km-test.ls-ecommerce.com.tw](http://km-test.ls-ecommerce.com.tw/).local;  
    access_log  /opt/homebrew/etc/log/nginx/km-test-local.host.access.log;  
    error_log   /opt/homebrew/etc/log/nginx/km-test-local.host.error.log;  
    location / {  
     proxy_pass [http://localhost:3001/](http://localhost:3001/);  
    }  
#    location /api/ {  
# proxy_pass [https://drew-test.leishan.app/](https://drew-test.leishan.app/);  
# add_header Access-Control-Allow-Origin *;  
#    } location /api/ {  
proxy_pass [https://km.leishan.app/api/](https://km.leishan.app/api/);  
add_header Access-Control-Allow-Origin *;  
}  
}
```
2.修改本地 hosts file：讓這個配置能生效

```shell
127.0.0.1 your-nginx-config
```

> hosts file 的路由通常是 `/private/etc` 

3.以 pm2 的指令啟動這個專案，啟動方式是執行 pm2 的配置，以這個專案為例就是

```js
//leishan.config.js

```
以本來的配置會報錯，所以目前會對配置檔案做以下調整：
```js
API_BASE:'https://km.leishan.app/api/v1' > api/v1
script: 'start' > 'yarn dev'
```
1.API_BASE:以原本的配置會遇到 CORS，所以改成透過 nginx 處理能先繞開。
2.script: 以本來的指令會找不到對應路由


調整完後，再下 pm2 的啟動指令
```shell
pm2 start [pm2-config]
```

應該就會顯示

![[Pasted image 20240417114004.png]]