#km 


> 套件版本：7.4.2 （要注意對應文件）

---
### 如何設定

 `/locales` 存放各語系的設定，專案有設定三種語系

```
en
zh-cn
zh-tw
```

接著在 `/plugins` 產生 i18n 的基本設定

```js
//i18n.js

import Vue from 'vue'

import VueI18n from 'vue-i18n'
Vue.use(VueI18n)

  
export default ({ app, store }) => {

app.i18n = new VueI18n({

locale: store.state.locale,

fallbackLocale: 'en',

messages: {

	en: require('~/locales/en.js'),

	'zh-tw': require('~/locales/zh-tw.js'),

	'zh-cn': require('~/locales/zh-cn.js')

	}

})

app.i18n.path = (link) => {

return `/${app.i18n.locale}${link}`.replace(/\/+$/, '')

}

}
```
1. `locale`: 預設的語系
2. `fallbackLocale`: 當找不到語系時退回
3. `message`: 載入支援語系的檔案
4. `path`: 切換頁面時載入對應的語系

<br/>

透過引入 `nuxt.config.js` 來啟動此功能
```js
//nuxt.config.js
plugins:[
	'~/plugins/VueI18n'
]
```
---
### 功能

在 `/middleware` 內有名為 i18n.js 的檔案，它執行了以下內容：

```js
if(isHMR)return 
```
意思是：當這次 middleware/method 觸發在 client-side 且為開發模式時，終止往下執行。

```js
const locale = params.locale || Cookie.get('locale') || 'en'

if (Object.keys(store.getters.locales).indexOf(locale) === -1) {

return error({ message: 'This page could not be found.', statusCode: 404 })

}
```
1. 接著建立一個變數 `locale` 讀取當前的語系
2. 使用 `Object.key` 迭代 vuex 的語系狀態，若是找不到則回傳 `404` 狀態，表示找不到此頁面。

```js
Cookie.set('locale', locale)
store.commit('setLocale', locale)
app.i18n.locale = store.state.locale
```
通過上述的檢查後，將更新的語系分別存入 vuex,cookie,app 內。
