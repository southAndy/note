#react 

### 單向資料流

單向資料流，英文名為 *one-way dataflow* ，是指資料的傳遞是**單向且不可逆的**，**被傳遞者只能接收，不能反過來去修改源頭資料**。

這個概念在前端領域應用於管理畫面更新方式，方向統一是從資料更新觸發，最終在畫面顯示更新的結果。

> 補圖



> 圖片製作參考：
> React 思維進化：一次打破常見的觀念誤解，躍升專業前端開發者（iThome鐵人賽系列書）


但是要實現這件事要搭配 **資料管理與畫面分離**，將資料管理分離出來原因是，試想今天有一個資料會在多個頁面被使用。

### MVVM




### 渲染策略

React 是採取**一律重繪策略**，意思就是只要資料改變，整個頁面都會重新渲染一次。

這裡以書本提供的範例程式碼為例：

```jsx
const counterValues = [0, 0, 0];

function getNumbersSum(numbers) {
	return numbers.reduce((x, y) => x + y);
}

function handleIncrementButtonClick() {
	// 範例行為：increment counter 0 & counter 2
	
	counterValues[0] += 1;
	counterValues[2] += 1;
	
	// 不需要判斷這次資料更新具體會影響到的 DOM elements 有哪些
	
	// 一率直接呼叫 renderScreen() 來將整個畫面全部的 DOM elements 都清除後再全部重繪
	renderScreen();
}

function renderScreen() {
	// 每次要繪製新的畫面之前，都先把整個瀏覽器畫面全部清空
	document.body.innerHTML = '';
	
	// 依據目前的最新資料，重新繪製一次整個畫面的所有 DOM elements
	document.body.innerHTML = `
	<div id="counters-wrapper">
		<ul id="counter-list">
			${counterValues.map((counterValue, index) => `
				<li>counter ${index}: <span>${counterValue}</span></li>
			`).join('')
			}
		</ul>
	<div id="counter-sum">
		counters sum: <span>${getNumbersSum(counterValues)}</span>
	</div>
	</div>
	<button id="increment-btn">increment counter 0 & 2</button>
	`;

	// 重新綁定 increment button 事件
	document.getElementById('increment-btn').addEventListener('click', handleIncrementButtonClick);

}

renderScreen();
```

這樣做法的好處是，在更新資料後開發者 **不需要判斷這次資料更新具體會影響到的 DOM elements 有哪些**，因為會一律將畫面整個 DOM  elements 清除後，再重繪出全新的架構。

而顯著的缺點就是 **效能浪費**，因為會造成大量不必要的 DOM 操作，應用在大型架構的網站，容易破壞使用者體驗。


上述是傳統的一律重繪渲染策略， React 雖然維持 **一律重繪** 作為渲染策略，但了解不必要重繪 DOM 的效能消耗，所以**它在渲染 [[programming/前端/React/virtual DOM|virtual DOM]] 的過程加入比對機制 ，會根據新的資料去產生全新的 virtual DOM 架構，並將新舊版的 virtual DOM 進行比對**，比對出差異後執行真實的 DOM 渲染。


![[Pasted image 20250206113254.png]]

> 圖片製作參考：
> React 思維進化：一次打破常見的觀念誤解，躍升專業前端開發者（iThome鐵人賽系列書）


