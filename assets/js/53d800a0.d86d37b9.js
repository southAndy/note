"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[6876],{9369:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>d,toc:()=>o});var c=s(4848),t=s(8453);const l={},r="React - hooks",d={id:"react/hooks",title:"React - hooks",description:"useState",source:"@site/docs/react/hooks.md",sourceDirName:"react",slug:"/react/hooks",permalink:"/docs/react/hooks",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"techNoteSidebar",previous:{title:"\u4ecb\u7d39",permalink:"/docs/learn/intro"},next:{title:"useState",permalink:"/docs/react/useState"}},i={},o=[{value:"useState",id:"usestate",level:2},{value:"useEffect",id:"useeffect",level:2},{value:"\u4ec0\u9ebc\u662f\u526f\u4f5c\u7528",id:"\u4ec0\u9ebc\u662f\u526f\u4f5c\u7528",level:3},{value:"\u8a9e\u6cd5",id:"\u8a9e\u6cd5",level:3},{value:"\u89f8\u767c\u6642\u6a5f",id:"\u89f8\u767c\u6642\u6a5f",level:3},{value:"\u526f\u4f5c\u7528\u8207\u4f9d\u8cf4",id:"\u526f\u4f5c\u7528\u8207\u4f9d\u8cf4",level:3},{value:"useMemo",id:"usememo",level:2},{value:"\u9069\u7528\u60c5\u5883",id:"\u9069\u7528\u60c5\u5883",level:3},{value:"useCallback",id:"usecallback",level:2},{value:"\u8a9e\u6cd5",id:"\u8a9e\u6cd5-1",level:3},{value:"\u57f7\u884c\u6d41\u7a0b",id:"\u57f7\u884c\u6d41\u7a0b",level:3},{value:"\u4f7f\u7528\u60c5\u5883",id:"\u4f7f\u7528\u60c5\u5883",level:3}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.h1,{id:"react---hooks",children:"React - hooks"}),"\n",(0,c.jsx)(n.h2,{id:"usestate",children:"useState"}),"\n",(0,c.jsxs)(n.p,{children:["\u8acb\u53c3\u8003 ",(0,c.jsx)(n.a,{href:"/docs/react/useState",children:"useState"})]}),"\n",(0,c.jsx)(n.h2,{id:"useeffect",children:"useEffect"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"useEffect"})," \u7528\u65bc\u5728\u5143\u4ef6\u4e2d\u8ca0\u8cac\u8655\u7406\u526f\u4f5c\u7528 side effect"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u56e0\u70ba\u5b83\u53ef\u4ee5\u8a2d\u5b9a\u89f8\u767c\u6642\u6a5f\uff0c",(0,c.jsx)(n.strong,{children:"\u5e38\u5e38\u6703\u88ab\u7528\u4f86\u7576\u4f5c\u662f\u5143\u4ef6\u7684\u751f\u547d\u9031\u671f\u51fd\u5f0f\u4f7f\u7528"}),"\uff0c",(0,c.jsx)(n.em,{children:"React \u601d\u7dad\u9032\u5316"}),"\u4e00\u66f8\uff0c\u4f5c\u8005\u63d0\u4f9b\u4e86\u53e6\u4e00\u500b\u6982\u5ff5\uff0c\u4e0b\u9762\u6703\u8aaa\u660e"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"\u4ec0\u9ebc\u662f\u526f\u4f5c\u7528",children:"\u4ec0\u9ebc\u662f\u526f\u4f5c\u7528"}),"\n",(0,c.jsxs)(n.p,{children:["\u82f1\u6587\u662f side effect\uff0c\u901a\u5e38\u662f\u6307\u8207\u6e32\u67d3\u7121\u76f4\u63a5\u95dc\u806f\u7684\u64cd\u4f5c\uff0c\u50cf\u662f\u5f8c\u7aef\u8acb\u6c42\uff08\u547c\u53eb API \uff09\u3001\u64cd\u4f5c\u8cc7\u6599\u5eab\uff0c",(0,c.jsx)(n.strong,{children:"\u526f\u4f5c\u7528\u4e0d\u4e00\u5b9a\u662f\u8ca0\u9762\u7684"}),"\uff0c\u6211\u53ef\u80fd\u6703\u66f4\u50be\u5411\u7406\u89e3\u70ba\u300c\u6b21\u8981\u7684\u300d\u529f\u80fd\uff0c\u4f46\u662f\u5e38\u5e38\u5177\u6709 ",(0,c.jsx)(n.strong,{children:"\u4e0d\u53ef\u9810\u6e2c"}),"\u3001 ",(0,c.jsx)(n.strong,{children:"\u96e3\u6e2c\u8a66"})," \u7b49\u7279\u6027\u3002"]}),"\n",(0,c.jsx)(n.p,{children:"\u4f8b\u5982\uff0c\u4ee5\u5f8c\u7aef\u8acb\u6c42\u4f86\u8aaa\uff0c\u53ef\u80fd\u5c31\u6703\u53d7\u5230\u7db2\u8def\u72c0\u6cc1\u3001\u4f3a\u670d\u5668\u72c0\u6cc1\u7b49\u5916\u90e8\u56e0\u7d20\u5f71\u97ff\uff0c\u56e0\u6b64\u7121\u6cd5\u9810\u671f\u8cc7\u6599\u4f55\u6642\u6703\u56de\u4f86\uff0c\u53c8\u6216\u8005\u662f\u54ea\u500b\u8acb\u6c42\u6703\u5148\u56de\u4f86\u3002"}),"\n",(0,c.jsx)(n.h3,{id:"\u8a9e\u6cd5",children:"\u8a9e\u6cd5"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"useEffect"})," \u53ef\u50b3\u5165\u5169\u500b\u53c3\u6578\uff0c\u7b2c\u4e00\u500b\u662f effect function\uff0c\u64b0\u5beb\u5143\u4ef6\u6240\u9700\u7684\u526f\u4f5c\u7528\uff0c\u7b2c\u4e8c\u500b\u662f\u89f8\u767c\u4f9d\u8cf4\uff08\u4f9d\u8cf4\u6578\u91cf\u4e0d\u9650\uff09"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-jsx",children:"useEffect(effect,[])\n"})}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"effect function"}),": \u9664\u4e86\u8ca0\u8cac\u8655\u7406\u5143\u4ef6\u6240\u9700\u526f\u4f5c\u7528\u5916\uff0c\u4e5f\u53ef\u4ee5\u5728\u88e1\u9762\u64b0\u5beb ",(0,c.jsx)(n.em,{children:"clean function"})," \u6e05\u9664\u4e0d\u540c\u6e32\u67d3\u9593\u7684\u526f\u4f5c\u7528\uff0c\u907f\u514d\u9020\u6210\u4e0d\u5fc5\u8981\u7684\u526f\u4f5c\u7528\u5806\u7a4d\u9032\u800c\u5f15\u767c\u985e\u4f3c memory leak"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"dependencies"}),": \u6703\u53d7\u5230\u9019\u500b\u526f\u4f5c\u7528\u5f71\u97ff\u7684\u72c0\u614b\uff0c\u525b\u958b\u59cb\u5b78\u7fd2\u6642\u6703\u628a ",(0,c.jsx)(n.code,{children:"useEffect"})," \u7684\u4e0d\u540c\u89f8\u767c\u6642\u6a5f\u8996\u70ba\u5143\u4ef6\u4e0d\u540c\u751f\u547d\u9031\u671f\uff0c\u4f46\u662f\u5176\u5be6\u8981\u7528\uff0c\u5b83\u6709\u4ee5\u4e0b\u5e7e\u7a2e\u5beb\u6cd5\uff1a"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-jsx",children:"useEffect(effect)\nuseEffect(effect,[])\nuseEffect(effect,[dependencies])\n"})}),"\n",(0,c.jsx)(n.h3,{id:"\u89f8\u767c\u6642\u6a5f",children:"\u89f8\u767c\u6642\u6a5f"}),"\n",(0,c.jsxs)(n.p,{children:["\u5148\u8aaa\u7d50\u8ad6\uff0c",(0,c.jsx)(n.code,{children:"useEffect"})," \u521d\u6b21\u89f8\u767c\u6703\u5728\u5143\u4ef6\u5b8c\u6210\u6e32\u67d3\u5f8c\uff0cReact \u6703\u7279\u5225\u8a2d\u8a08\u9019\u500b hooks \u7684\u7528\u610f\u662f ",(0,c.jsx)(n.strong,{children:"\u78ba\u4fdd\u5143\u4ef6\u6e32\u67d3\u968e\u6bb5\u4e0d\u53d7\u5230\u4efb\u4f55\u526f\u4f5c\u7528\u5f71\u97ff"}),"\uff0c\u70ba\u4ec0\u9ebc\u5462\uff1f\u8b93\u6211\u5011\u8a66\u8457\u53cd\u5411\u601d\u8003\uff0c ",(0,c.jsx)(n.strong,{children:"\u5982\u679c\u89f8\u767c\u6642\u6a5f\u5728\u6e32\u67d3\u968e\u6bb5\u6703\u600e\u6a23\uff1f"})]}),"\n",(0,c.jsx)(n.h3,{id:"\u526f\u4f5c\u7528\u8207\u4f9d\u8cf4",children:"\u526f\u4f5c\u7528\u8207\u4f9d\u8cf4"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u52a0\u5165\u4f9d\u8cf4\u662f\u4e00\u7a2e\u6548\u80fd\u512a\u5316\u7684\u505a\u6cd5\uff0c\u800c\u4e0d\u662f\u8a2d\u5b9a\u6642\u6a5f\u9ede\u7684\u4f5c\u6cd5"})}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"1.\u591a\u500b\u72c0\u614b\u5f71\u97ff\u529f\u80fd\u8f38\u51fa\u503c"}),"\uff1a\n\u7576\u9019\u500b ",(0,c.jsx)(n.code,{children:"useEffect"})," \u8655\u7406\u7684\u529f\u80fd\uff0c\u53d7\u5230\u591a\u500b\u72c0\u614b\u5f71\u97ff\u6642\uff0c\u4f8b\u5982\uff1a"]}),"\n",(0,c.jsx)(n.p,{children:"\u4eca\u5929\u64b0\u5beb\u4e00\u500b\u7e3d\u8cbb\u7528\u8a08\u7b97\u7684\u529f\u80fd\uff0c\u7576\u50f9\u683c\u6216\u662f\u6298\u6263\u6578\u72c0\u614b\u6539\u8b8a\u6642\u90fd\u61c9\u8a72\u8981\u89f8\u767c\uff0c\u56e0\u70ba\u5169\u500b\u72c0\u614b\u90fd\u5f71\u97ff\u8457\u6700\u7d42\u7684\u8f38\u51fa\u503c\uff0c\u9019\u6642\u5019\u5c31\u6703\u9700\u8981\u540c\u6642\u76e3\u807d\u9019\u5169\u500b\u72c0\u614b\u3002"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-jsx",children:"const component = ()=>{\n\tconst [price,setPrice] = useState(0);\n\tconst [discount,setDiscount] = useState(7);\n\tconst [total,setTotal] = useState(0)\n\n\t// \u8cbb\u7528\u8a08\u7b97\u529f\u80fd\n\tuseEffect(()=>{\n\t\tsetTotal((total)=>total = price * discount)\n\t},[price,discount])\n}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"usememo",children:"useMemo"}),"\n",(0,c.jsx)(n.p,{children:"\u7528\u65bc\u7de9\u5b58\u91cd\u65b0\u6e32\u67d3\u9593\u7684\u8a08\u7b97\u7d50\u679c\uff0c\u6e1b\u5c11\u4e0d\u5fc5\u8981\u7684\u6e32\u67d3\uff0c\u9032\u4e00\u6b65\u63d0\u5347\u7db2\u7ad9\u6027\u80fd\u3002"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-jsx",children:"const memoTodo = useMemo(calculateValue,[dependencies])\t\n"})}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"calculateValue"}),"\uff1a\u9700\u8981\u662f\u4e00\u500b ",(0,c.jsx)(n.em,{children:"pure function"}),"\uff0c\u6703\u5728\u521d\u6b21\u6e32\u67d3\u6642\u57f7\u884c\u4e00\u6b21\uff0c\u7576 ",(0,c.jsx)(n.code,{children:"dependencies"})," \u6539\u8b8a\u6642\u624d\u6703\u518d\u6b21\u57f7\u884c\u3002"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"dependencies"}),"\uff1a\u76e3\u807d\u7684\u72c0\u614b\uff0c\u53ef\u4ee5\u6709\u591a\u500b\u4f9d\u8cf4\u72c0\u614b"]}),"\n"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u5beb Vue \u7684\u4eba\u53ef\u4ee5\u7528 ",(0,c.jsx)(n.code,{children:"computed"})," \u53bb\u601d\u8003\u9019\u500b hooks"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"\u9069\u7528\u60c5\u5883",children:"\u9069\u7528\u60c5\u5883"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsx)(n.li,{children:"\u907f\u514d\u5927\u91cf\u8cc7\u6599\u7684\u91cd\u65b0\u8a08\u7b97\uff1a\u7576\u67d0\u500b\u72c0\u614b\u662f\u5132\u5b58 API \u7be9\u9078\u8cc7\u6599\u7684\u7d50\u679c\u6642\uff0c\u5047\u8a2d\u4eca\u5929 API \u8cc7\u6599\u7b46\u6578\u5f88\u591a\u6642\uff0c\u6bcf\u6b21\u91cd\u65b0\u7be9\u9078\u90fd\u76f8\u7576\u8017\u6642\u3002"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"usecallback",children:"useCallback"}),"\n",(0,c.jsxs)(n.p,{children:["\u7531\u65bc React \u662f\u63a1\u53d6 ",(0,c.jsx)(n.em,{children:"\u4e00\u5f8b\u91cd\u7e6a"})," \u7684\u6e32\u67d3\u7b56\u7565\uff0c\u6240\u4ee5\u51fd\u5f0f\u4e5f\u6703\u5728\u6bcf\u6b21\u6e32\u67d3\u9593\u88ab\u91cd\u65b0\u5ba3\u544a\uff0c\u900f\u904e ",(0,c.jsx)(n.code,{children:"useCallback"})," \u5728\u5408\u9069\u7684\u8a2d\u8a08\u4e0b\uff0c\u80fd\u8b93\u51fd\u5f0f\u5728\u6b63\u78ba\u7684\u6642\u6a5f\u4e0b\u91cd\u65b0\u5ba3\u544a\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"\u8a9e\u6cd5-1",children:"\u8a9e\u6cd5"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-jsx",children:"const callback = useCallback(func,[dependencies,dependencies])\n"})}),"\n",(0,c.jsx)(n.h3,{id:"\u57f7\u884c\u6d41\u7a0b",children:"\u57f7\u884c\u6d41\u7a0b"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\u5c07\u65b0\u820a ",(0,c.jsx)(n.em,{children:"dependencies"})," \u9032\u884c\u6bd4\u8f03\uff1a","\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsx)(n.li,{children:"\u767c\u751f\u8b8a\u5316\uff1a\u5c07\u6b64\u6b21\u6e32\u67d3\u5ba3\u544a\u7522\u751f\u7684\u51fd\u5f0f\u91cd\u65b0\u5b58\u5165"}),"\n",(0,c.jsx)(n.li,{children:"\u6c92\u6709\u767c\u751f\uff1a\u7de9\u5b58\u524d\u6b21\u6e32\u67d3\u7684\u51fd\u5f0f"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u4f60\u6703\u767c\u73fe ",(0,c.jsx)(n.code,{children:"useCallback"})," ",(0,c.jsx)(n.strong,{children:"\u4e0d\u80fd\u963b\u6b62\u4e0d\u5fc5\u8981\u7684\u51fd\u5f0f\u91cd\u65b0\u5ba3\u544a"}),"\uff0c\u6bcf\u6b21\u5143\u4ef6\u91cd\u65b0\u6e32\u67d3\uff0c\u51fd\u5f0f\u90fd\u9084\u662f\u6709\u88ab\u5ba3\u544a\u7522\u751f\uff0c\u56e0\u6b64 ",(0,c.jsx)(n.code,{children:"useCallback"})," \u6211\u81ea\u5df1\u7406\u89e3\u771f\u6b63\u7684\u7528\u9014\u662f ",(0,c.jsx)(n.strong,{children:"\u78ba\u4fdd\u51fd\u5f0f\u8655\u7406\u908f\u8f2f\u80fd\u8ddf\u72c0\u614b\u540c\u6b65"})]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"\u4f7f\u7528\u60c5\u5883",children:"\u4f7f\u7528\u60c5\u5883"}),"\n",(0,c.jsxs)(n.p,{children:["\u4eca\u5929 Page \u9801\u9762\u5728\u6bcf\u6b21\u6e32\u67d3\u90fd\u6703\u89f8\u767c\u7684\u526f\u4f5c\u7528\u662f ",(0,c.jsx)(n.strong,{children:"\u7d22\u53d6 API \u8cc7\u6599"})," \u7684\u526f\u4f5c\u7528\uff0c\u671f\u671b\u9054\u5230\u7684\u512a\u5316\u662f ",(0,c.jsx)(n.strong,{children:"\u53ea\u6709\u7576 query \u72c0\u614b\u6539\u8b8a\u6642"}),"\uff0c\u624d\u9700\u8981\u91cd\u65b0\u7522\u751f\u65b0\u7684 ",(0,c.jsx)(n.code,{children:"fetchData"})," \u51fd\u5f0f\uff0c\u9019\u7a2e\u53d7\u5230 ",(0,c.jsx)(n.strong,{children:"\u4f9d\u8cf4\u6539\u8b8a"})," \u800c\u5f71\u97ff\u7684\u51fd\u5f0f\uff0c\u5c31\u5f88\u9069\u5408\u52a0\u5165 ",(0,c.jsx)(n.code,{children:"useCallback"})," \u53bb\u6e1b\u5c11\u4e0d\u5fc5\u8981\u7684\u51fd\u5f0f\u5efa\u69cb\u3002"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-jsx",children:"export const Page = ()=>{\n\tconst [query,setQuery] = useState('')\n\n\tuseEffect(()=>{\n\t\tfetchData()\n\t},[fetchData])\n\n\t//\u672a\u52a0\u5165 useCallback\n\tfunctino fetchData(){\n\t\treturn fetch(`urls/${query}`).then((res)=>res.json())\t\t\n\t};\n\n\t//\u52a0\u5165 useCallback\uff1a\u9019\u6a23\u4e00\u4f86\u82e5\u662f query \u6c92\u6709\u6539\u8b8a\uff0c\u5c31\u6c92\u6709\u66f4\u65b0\u51fd\u5f0f\u53c3\u7167\u7684\u5fc5\u8981\n\tconst fetchData = useCallback(()=>{\n\t\treturn fetch(`urls/${query}`).then((res)=>res.json())\n\t},[query])\n\n}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>d});var c=s(6540);const t={},l=c.createContext(t);function r(e){const n=c.useContext(l);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),c.createElement(l.Provider,{value:n},e.children)}}}]);