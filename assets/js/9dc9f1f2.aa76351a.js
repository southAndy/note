"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[8311],{7289:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>l,toc:()=>i});var s=t(4848),a=t(8453);const c={},r="useState",l={id:"react/useState",title:"useState",description:"\u70ba\u4f55\u9700\u8981 state",source:"@site/docs/react/useState.md",sourceDirName:"react",slug:"/react/useState",permalink:"/docs/react/useState",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"techNoteSidebar",previous:{title:"React - hooks",permalink:"/docs/react/hooks"},next:{title:"Redux - \u6a5f\u5236\u521d\u63a2",permalink:"/docs/react/Redux-basic"}},d={},i=[{value:"\u70ba\u4f55\u9700\u8981 state",id:"\u70ba\u4f55\u9700\u8981-state",level:2},{value:"\u4f7f\u7528\u9650\u5236",id:"\u4f7f\u7528\u9650\u5236",level:2},{value:"\u56de\u50b3\u503c",id:"\u56de\u50b3\u503c",level:2},{value:"\u5982\u4f55\u66f4\u65b0 state \uff1f",id:"\u5982\u4f55\u66f4\u65b0-state-",level:2},{value:"Primitive types",id:"primitive-types",level:3},{value:"Reference types",id:"reference-types",level:3},{value:"\u7269\u4ef6\u578b\u5225\u66f4\u65b0",id:"\u7269\u4ef6\u578b\u5225\u66f4\u65b0",level:4},{value:"\u9663\u5217\u578b\u5225\u66f4\u65b0",id:"\u9663\u5217\u578b\u5225\u66f4\u65b0",level:4},{value:"\u72c0\u614b\u66f4\u65b0\u6a5f\u5236",id:"\u72c0\u614b\u66f4\u65b0\u6a5f\u5236",level:2},{value:"updater function",id:"updater-function",level:3},{value:"batch update \u6a5f\u5236",id:"batch-update-\u6a5f\u5236",level:3}];function o(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"usestate",children:"useState"}),"\n",(0,s.jsx)(n.h2,{id:"\u70ba\u4f55\u9700\u8981-state",children:"\u70ba\u4f55\u9700\u8981 state"}),"\n",(0,s.jsxs)(n.p,{children:["\u4eca\u5929\u6211\u5011\u5148\u4f7f\u7528\u4e00\u500b\u666e\u901a\u7684 Javascript \u8b8a\u6578 ",(0,s.jsx)(n.code,{children:"number"})," \u4f5c\u70ba\u72c0\u614b\u503c\uff0c\u7576\u9ede\u64ca\u756b\u9762\u4e0a\u7684\u6309\u9215\u6642\uff0c\u89f8\u767c\u4e8b\u4ef6\u6642\u540c\u6a23\u6703\u66f4\u65b0\u5b83\u7684\u503c\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"//\u72c0\u614b\u8b8a\u6578\nexport default  addButton = () =>{\n\tconst number = 0;\n\tconst addNumber = ()=>{number = number+1 }\n\treturn (\n\t\t<>\n\t\t  <p> current {number} </p>\n\t\t  <button onClick={addNumber}></button>\n\t\t</>\n\t)\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4f60\u6703\u767c\u73fe\u9019\u500b\u72c0\u614b\u503c\u7684\u8b8a\u5316\u7121\u6cd5\u88ab\u4fdd\u5b58\uff0c\u56e0\u70ba\u6bcf\u6b21\u91cd\u65b0\u6e32\u67d3\u9801\u9762\u6642\u90fd\u6703\u91cd\u65b0\u70ba ",(0,s.jsx)(n.code,{children:"number"})," \u8ce6\u503c\u3002 react \u63d0\u4f9b\u7684 ",(0,s.jsx)(n.code,{children:"useState"})," \u7522\u751f\u7684\u72c0\u614b\u503c\uff0c\u9664\u4e86\u53ef\u4ee5\u89e3\u6c7a",(0,s.jsx)(n.strong,{children:"\u6578\u503c\u6539\u8b8a\u7121\u6cd5\u5728\u9801\u9762\u6e32\u67d3\u9593\u88ab\u4fdd\u5b58\u7684\u554f\u984c"}),"\u5916\uff0c\u4e5f",(0,s.jsxs)(n.strong,{children:["\u5c07 ",(0,s.jsx)(n.code,{children:"state"})," \u6539\u8b8a\u8207\u9801\u9762\u6e32\u67d3\u9032\u884c\u639b\u9264"]}),"\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"\u4f7f\u7528\u9650\u5236",children:"\u4f7f\u7528\u9650\u5236"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"\u53ea\u80fd\u5728 function component \u4f7f\u7528 \uff0cclass component \u4e0d\u80fd"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.strong,{children:["\u53ea\u80fd\u5728 function component \u5167\u7684 top-level \u547c\u53eb\uff0c\u4e0d\u53ef\u5728 ",(0,s.jsx)(n.code,{children:"block scoped"})," \u547c\u53eb"]})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u800c\u6240\u8b02\u7684 block scoped \u8209\u4f8b\u4f86\u8aaa\u5c31\u5305\u62ec\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import {useState} from 'react'\n\nexport default LimitShow = ()=>{\n\tuseState() //\u53ef\n\tif(true) { useState(1) } // \u4e0d\u53ef\n\tfor(xx) { useState(1) } // \u4e0d\u53ef\n\n\treturn <></>\n}\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.strong,{children:["\u66f4\u65b0 state \u9700\u9075\u5b88 ",(0,s.jsx)(n.strong,{children:"immutable"})," \u539f\u5247"]})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5728 Javascript \u4e2d\u8cc7\u6599\u4e3b\u8981\u5206\u70ba\u5169\u7a2e\u985e\u578b\uff0c ",(0,s.jsx)(n.em,{children:"Primitive types"})," \u53ca ",(0,s.jsx)(n.em,{children:"Reference types"})," \uff0c\u50cf\u662f ",(0,s.jsx)(n.code,{children:"Number"}),",",(0,s.jsx)(n.code,{children:"String"}),",",(0,s.jsx)(n.code,{children:"Boolean"})," \u7b49\u985e\u578b\u7684\u8cc7\u6599\uff0c\u5c31\u662f\u6240\u8b02\u7684 ",(0,s.jsx)(n.em,{children:"Primitive types"})," \u7684\u985e\u578b\uff0c\u800c\u50cf\u662f ",(0,s.jsx)(n.code,{children:"Array"})," , ",(0,s.jsx)(n.code,{children:"Object"})," \u9019\u985e\u578b\u7684\u8cc7\u6599\u5247\u70ba ",(0,s.jsx)(n.em,{children:"Reference types"})," \u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u5982\u4f55\u5340\u5206\u5169\u8005\uff1f"})}),"\n",(0,s.jsxs)(n.p,{children:["\u7576\u4f60\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"const"})," \u9032\u884c\u5ba3\u544a\u6642\uff0c",(0,s.jsx)(n.em,{children:"Primitive types"})," \u7684\u8cc7\u6599\u7121\u6cd5\u518d\u91cd\u65b0\u8ce6\u503c\uff0c\u9019\u5c31\u7b26\u5408\u6240\u8b02\u7684 ",(0,s.jsx)(n.em,{children:"immutable"}),"\uff08\u4e0d\u53ef\u6539\u8b8a\uff09"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const x = 2;\nx = 3; //error x is constant variable\n\nconst y = x; //ok!\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53cd\u4e4b\uff0c\u4f60\u4ecd\u53ef\u5c0d ",(0,s.jsx)(n.em,{children:"Reference types"})," \u7684\u8cc7\u6599\u9032\u884c\u8abf\u6574\uff0c\u6216\u662f\u62f7\u8c9d\uff0c\u9019\u5c31\u662f\u6240\u8b02\u7684 ",(0,s.jsx)(n.em,{children:"mutable"}),"\uff08\u53ef\u6539\u8b8a\uff09"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'const objX = {name:"andy"};\nobjX.name = "danny" // ok!\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u70ba\u4f55 react \u6703\u56b4\u683c\u9650\u5236 state \u9700\u9075\u5b88 ",(0,s.jsx)(n.em,{children:"immutable"})," \u539f\u5247\uff1f \u4f5c\u8005\u7406\u89e3 ",(0,s.jsx)(n.strong,{children:"react \u662f\u900f\u904e\u5075\u6e2c\u72c0\u614b(state)\u8a18\u61b6\u9ad4\u4f4d\u7f6e\u6539\u8b8a\uff0c\u4f86\u6c7a\u5b9a\u662f\u5426\u8981\u91cd\u65b0\u6e32\u67d3"}),"\uff0c\u7576\u4f60\u76f4\u63a5\u5c0d ",(0,s.jsx)(n.em,{children:"Reference types"})," \u7684\u8cc7\u6599\u9032\u884c\u8abf\u6574\u6642\uff0c\u8a18\u61b6\u9ad4\u4f4d\u7f6e\u4e26\u6c92\u6709\u6539\u8b8a\uff0c\u6703\u767c\u751f\u8cc7\u6599\u5df2\u7d93\u6539\u8b8a\uff0c\u4f46\u662f\u756b\u9762\u6c92\u6709\u66f4\u65b0\u7684\u60c5\u5f62\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"\u56de\u50b3\u503c",children:"\u56de\u50b3\u503c"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"useState"}),"  \u6703\u56de\u50b3\u4e00\u500b\u9663\u5217 \uff0cindex: 0 \u662f\u521d\u59cb\u7684 ",(0,s.jsx)(n.code,{children:"state"})," \uff0cindex: 1 \u5247\u662f\u66f4\u65b0 ",(0,s.jsx)(n.code,{children:"state"})," \u7684\u51fd\u5f0f\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"function LimitShow(){\n\tconst state = useState(1);\n\tstate = [1,handlerState()]\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u6240\u4ee5\u4e00\u822c\u4f7f\u7528\u4e0a\u6703\u642d\u914d\u89e3\u69cb\u8ce6\u503c\u5c07 ",(0,s.jsx)(n.strong,{children:"\u5132\u5b58\u72c0\u614b\u8b8a\u6578"})," \u8ddf ",(0,s.jsx)(n.strong,{children:"\u8655\u7406\u72c0\u614b\u8b8a\u6578\u51fd\u5f0f"})," \u89e3\u69cb\uff0c\u65b9\u4fbf\u5404\u5225\u4f7f\u7528\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const [state,setState] = useState(1);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u5982\u4f55\u66f4\u65b0-state-",children:"\u5982\u4f55\u66f4\u65b0 state \uff1f"}),"\n",(0,s.jsx)(n.h3,{id:"primitive-types",children:"Primitive types"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const [state,setState] = useState(1)\n\n//\u66f4\u65b0\u65b9\u5f0f\nsetState(val)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"reference-types",children:"Reference types"}),"\n",(0,s.jsxs)(n.p,{children:["\u76f4\u63a5\u66f4\u65b0 ",(0,s.jsx)(n.strong,{children:"reference type"})," \u7684\u8cc7\u6599\u5167\u5bb9\uff08\u5982\u4e0b\u5716\uff09\uff0c\u5728 react \u7121\u6cd5\u88ab\u5075\u6e2c\u5230 ",(0,s.jsx)(n.code,{children:"state"})," \u6709\u7522\u751f\u6539\u8b8a\uff0c\u756b\u9762\u66f4\u65b0\u6703\u5931\u6548\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const [test,setTest] = useState({name:'1'})\n// x: \u76f4\u63a5\u66f4\u65b0\u7269\u4ef6 key \u503c\nsetState(()=>test.name=\"2\")\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8981\u4fdd\u6301 state \u503c\u7dad\u6301 ",(0,s.jsx)(n.code,{children:"immutable"}),"\u7684\u60c5\u5f62\u53bb\u66f4\u65b0\uff0c\u6709\u4ee5\u4e0b\u65b9\u6cd5\uff1a"]}),"\n",(0,s.jsx)(n.h4,{id:"\u7269\u4ef6\u578b\u5225\u66f4\u65b0",children:"\u7269\u4ef6\u578b\u5225\u66f4\u65b0"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u96e2\u6563\u8a9e\u6cd5"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const [state,setState] = useState({x:1,y:2})\n\nsetState({...state,\u8981\u66f4\u65b0\u90e8\u5206\u7684\u503c})\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u5b58\u5165\u5168\u65b0\u7269\u4ef6"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const [state,setState] = useState({x:1,y:2})\nsetState({x:2,y:3})\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e0a\u9762\u90fd\u662f\u55ae\u5c64\u7269\u4ef6\u8cc7\u6599\uff0c\u5982\u679c\u4eca\u5929\u662f\u5de2\u72c0\uff08nested\uff09\u7684\u72c0\u614b\uff08\u5982\u4e0b\uff09\uff0c\u53ef\u4ee5\u9019\u6a23\u601d\u8003\u53bb\u62c6\u89e3"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"export default function nestObj(){\n  const [obj,setObj] =useState({\n\tname:\"andy\",\n\tinterest:{ball:'basketball'}\n  })\n}\n\n"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\u628a ",(0,s.jsx)(n.code,{children:"interest"})," \u7269\u4ef6\u5148\u55ae\u7368\u62c9\u51fa\u4f86"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const newInterest = {...obj.interest}\nnewInterest.ball = 'baseball'\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["\u518d\u5c07\u66f4\u65b0\u7684\u503c\u5b58\u5165\u672c\u4f86\u7684\u72c0\u614b  ",(0,s.jsx)(n.code,{children:"interest"})," \u7269\u4ef6"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"setObj({...obj,interest:newInterest})\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6240\u4ee5\u5176\u5be6\u5c31\u662f\u55ae\u5c64\u7684\u66f4\u65b0\u65b9\u6cd5\u505a\u5169\u6b21\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"\u9663\u5217\u578b\u5225\u66f4\u65b0",children:"\u9663\u5217\u578b\u5225\u66f4\u65b0"}),"\n",(0,s.jsx)(n.p,{children:"\u9663\u5217\u5982\u540c\u7269\u4ef6\u662f mutable \u7684\uff0c\u4e14\u8a31\u591a\u5167\u5efa\u7684\u9663\u5217\u65b9\u6cd5\u6703\u4fee\u6539\u539f\u59cb\u9663\u5217\u9020\u6210 mutable \uff0c\u9019\u908a\u6211\u64f7\u53d6\u4e86 react \u5b98\u65b9\u6587\u4ef6\u5167\u689d\u5217\u7684\u6bd4\u8f03\u8868\uff08\u5982\u4e0b\uff09\uff0c\u900f\u904e\u9019\u5f35\u8868\u53ef\u4ee5\u5feb\u901f\u77e5\u9053\uff0c\u8981\u907f\u514d\u76f4\u63a5\u4f7f\u7528\u54ea\u4e9b\u65b9\u6cd5\u66f4\u65b0 state \u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:t(5809).A+"",width:"1686",height:"622"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["\u5716\u7247\u4f86\u6e90\uff1a",(0,s.jsx)(n.a,{href:"https://react.dev/learn/updating-arrays-in-state",children:"https://react.dev/learn/updating-arrays-in-state"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u52a0\u5165\u65b0\u7684\u8cc7\u6599"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4e00\u822c\u4f86\u8aaa\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"push"})," (\u65b0\u589e\u8cc7\u6599\u5230\u6700\u5f8c\u4e00\u7b46)\u3001",(0,s.jsx)(n.code,{children:"unshift"})," (\u65b0\u589e\u8cc7\u6599\u5230\u7b2c\u4e00\u7b46)\uff0c\u4f46\u9019\u5169\u7a2e\u90fd\u662f mutable \u7684\u65b9\u6cd5\uff0c\u9019\u908a\u540c\u6a23\u53ef\u4f7f\u7528\u96e2\u6563\u8a9e\u6cd5\u66ff\u4ee3"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const [state,setState] = useState([x,y,z])\n//\u628a\u65b0\u8cc7\u6599\u653e\u5230\u6700\u5f8c\u4e00\u7b46\nseState([...state,newData])\n//\u628a\u65b0\u8cc7\u6599\u653e\u5728\u7b2c\u4e00\u7b46\nsetState([newData,...state])\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u5c07\u8cc7\u6599\u52a0\u5165\u9663\u5217\u4e2d\u7684\u7279\u5b9a\u4f4d\u7f6e"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4f7f\u7528\u96e2\u6563\u8a9e\u6cd5\u642d\u914d ",(0,s.jsx)(n.code,{children:"slice"})," \u5c31\u80fd\u5be6\u73fe"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"setState(...state.slice(0,1),newData)\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"slice(a,b)"})," \u7684\u5169\u500b\u53c3\u6578\u5206\u5225\u662f\u6307 a:\u5f9e\u9663\u5217\u4e2d\u7b2c\u5e7e\u500b\u7d22\u5f15\u503c\u958b\u59cb  b:\u5230\u54ea\u500b\u7d22\u5f15\u503c\u505c\u4e0b\uff08\u4f46\u4e0d\u5305\u542b\u90a3\u500b\u7d22\u5f15\u503c\uff09"]})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u5982\u4f55\u4f7f\u7528 mutable \u65b9\u6cd5"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5176\u5be6\u4e0a\u8ff0\u5716\u8868\u6703\u9020\u6210 mutable \u7684\u65b9\u6cd5\uff0c\u5728 react \u4e26\u4e0d\u662f\u4e0d\u80fd\u4f7f\u7528\uff0c\u5148\u91d0\u6e05\u4f7f\u7528\u5b83\u5011\u6703\u7522\u751f\u7684\u554f\u984c\u662f ",(0,s.jsx)(n.strong,{children:'"\u5f71\u97ff\u672c\u4f86\u7684\u9663\u5217"'}),"\uff0c\u6240\u4ee5\u53ea\u8981\u80fd\u907f\u514d\u9019\u500b\u60c5\u6cc1\uff0c\u5176\u5be6\u9084\u662f\u80fd\u4f7f\u7528\u7684\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u8981\u4e0d\u5f71\u97ff\u672c\u4f86\u7684\u9663\u5217\uff0c\u5e38\u898b\u7684\u65b9\u6cd5\u5c31\u662f\u8907\u88fd\u9663\u5217\uff0c\u6211\u5011\u53ef\u900f\u904e\u96e2\u6563\u8a9e\u6cd5\u5b8c\u6210\u9019\u4ef6\u4e8b\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const [state,setState] = useState([1,2,3,4])\n\n//\u96e2\u6563\u8907\u88fd\u4e00\u500b\nconst sepArray = [...state]\n\n//\u9019\u6642\u4f7f\u7528 mutable \u7684\u65b9\u6cd5\uff08\u53cd\u8f49\u3001\u6392\u5e8f\uff09\u4e5f\u6c92\u5dee\uff0c\u56e0\u70ba mutable \u5f71\u97ff\u7684\u4e5f\u4e0d\u662f state \nconst versedArray = sepArray.reverse()\nconst sortedArray = sepArray.sort()\n\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4f46\u4eca\u5929\u9663\u5217\u5167\u7684\u8cc7\u6599\u82e5\u662f ",(0,s.jsx)(n.em,{children:"reference types"})," \u7684 \uff08\u5982\u7269\u4ef6\u3001\u9663\u5217\uff09\uff0c\u5373\u4fbf\u8907\u88fd\u4e86\u9663\u5217\u4ecd\u6703\u89f8\u767c mutable \u7684\u554f\u984c\uff0c\u539f\u56e0\u662f\u96e2\u6563\u8a9e\u6cd5\u662f\u6240\u8b02\u7684 ",(0,s.jsx)(n.a,{href:"https://www.explainthis.io/zh-hant/swe/shallow-copy-and-deep-copy",children:"shadow copy (\u6dfa\u62f7\u8c9d)"}),"\uff0c\u8cc7\u6599\u67b6\u69cb\uff08\u5982\u4e0b\uff09\u5167\u90e8\u7684\u7269\u4ef6\u5176\u5be6\u6c92\u6709\u88ab\u8907\u88fd\u5230\uff0c\u4ecd\u7136\u6307\u5411\u672c\u4f86\u7684\u4f4d\u7f6e\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'const [state,setState] = useState([{name:"andy"}])\n\n//\u53ea\u6709\u8907\u88fd\u5916\u5c64\u9663\u5217\uff0c\u5167\u90e8\u7269\u4ef6\u9084\u662f\u6307\u5411\u76f8\u540c\u8a18\u61b6\u9ad4\nconst copyState = [...state]\ncopyState[0].name = "danny" // \u7522\u751f mutable \u554f\u984c \n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u6240\u4ee5\u9047\u5230\u9019\u6a23\u7684\u8cc7\u6599\u985e\u578b\uff0c\u4f60\u6703\u540c\u6642\u9700\u8981\u7522\u751f\u65b0\u7684\u9663\u5217\u53ca\u7269\u4ef6\uff0c\u5b98\u65b9\u6587\u4ef6\u7684\u7bc4\u4f8b\u662f\u4f7f\u7528\u7528 ",(0,s.jsx)(n.code,{children:"map"})," \u642d\u914d\u96e2\u6563\u8a9e\u6cd5\uff1a"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"map"})," \u7528\u4f86\u7522\u751f\u65b0\u7684\u9663\u5217\uff0c\u96e2\u6563\u8a9e\u6cd5\u6dfa\u62f7\u8c9d\u88e1\u9762\u7684\u7269\u4ef6\u8cc7\u6599\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const [state,setState] = useState([{name:\"andy\"}])\nconst copyState = state.map((data)=>{return {...data}})\n\ncopyState[0].name = 'danny' // ok!\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u72c0\u614b\u66f4\u65b0\u6a5f\u5236",children:"\u72c0\u614b\u66f4\u65b0\u6a5f\u5236"}),"\n",(0,s.jsxs)(n.p,{children:["\u5047\u8a2d\u4eca\u5929\u4f60\u5be6\u4f5c\u4e86\u4e00\u500b\u9ede\u64ca\u529f\u80fd\uff0c\u9ede\u64ca\u6309\u9215\u5f8c\u5f48\u8df3\u8996\u7a97\u6703\u986f\u793a\u66f4\u65b0\u5f8c\u7684\u72c0\u614b\u503c\uff08\u5982\u4e0b\u5716\uff09\uff0c\u4f46\u662f\u7576\u4f60\u5be6\u969b\u9ede\u64ca\u5f8c\uff0c\u767c\u73fe\u986f\u793a\u5728\u5f48\u7a97\u5167\u7684\u4ecd\u7136\u662f\u820a\u7684\u6578\u503c\uff0c\u9019\u908a\u5c31\u8981\u5e36\u5230\u53e6\u4e00\u500b\u91cd\u8981\u89c0\u5ff5\uff1a",(0,s.jsx)(n.strong,{children:"State \u66f4\u65b0\u662f\u975e\u540c\u6b65\u7684"}),"\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"export default AlertSection = ()=>{\n\tconst [message,setMessage] = useState(0)\n\tconst alertMessage = ()=>{\n\t\tsetMessage(2)\n\t\talert(`message is update! ${message}`)\n\t}\n\treturn (\n\t\t<>\n\t\t\t<button onClick={alertMessage}>alert</button>\n\t\t\t<p>{message}</p>\n\t\t</>\n\t)\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u518d\u7cbe\u78ba\u5730\u4f86\u8aaa\uff1a",(0,s.jsx)(n.strong,{children:"State \u6703\u7b49\u6b64\u6b21\u6e32\u67d3\u7684\u6240\u6709\u884c\u70ba\u7d50\u675f\u5f8c\u624d\u9032\u884c\u66f4\u65b0"}),"\uff0c\u610f\u601d\u5c31\u662f\u8aaa\u5728\u7576\u6b21\u89f8\u767c\u7684\u884c\u70ba\u5167\uff0c\u4f60\u80fd\u8b80\u53d6\u5230\u7684 State \u90fd\u662f\u820a\u7684\uff0c"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"export default AlertSection = ()=>{\n\tconst [message,setMessage] = useState(0)\n\tconst alertMessage = ()=>{\n\t\tsetMessage(2)\n\t\talert(`message is update! ${message}`)\n\t}\n\treturn (\n\t\t<>\n\t\t\t<button onClick={alertMessage}>alert</button>\n\t\t\t<p>{message}</p>\n\t\t</>\n\t)\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u91cd\u770b\u4e00\u6b21\u9019\u500b\u4f8b\u5b50\uff0c\u4e4b\u6240\u4ee5 ",(0,s.jsx)(n.code,{children:"alert()"})," \u51fa\u4f86\u7684 ",(0,s.jsx)(n.code,{children:"message"})," \u4ecd\u7136\u662f 0 \uff0c\u5c31\u662f\u56e0\u70ba\u6b64\u6b21\u6e32\u67d3\u7684\u7a0b\u5e8f\u9084\u6c92\u7d50\u675f\uff0c \u6240\u4ee5 state \u5c1a\u672a\u66f4\u65b0\uff0c\u5982\u679c\u4f60\u5e0c\u671b\u80fd\u5373\u6642\u8b80\u53d6\u5230 state \u7684\u66f4\u65b0\u72c0\u614b\uff0c React \u6709\u63d0\u4f9b ",(0,s.jsx)(n.em,{children:"updater function"})," \u5e6b\u52a9\u4f60\u5be6\u73fe\u9019\u4ef6\u4e8b\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"updater-function",children:"updater function"}),"\n",(0,s.jsxs)(n.p,{children:["\u6240\u8b02\u7684 updater function \u5c31\u662f\u4f60\u5c07\u51fd\u5f0f\u50b3\u5165 ",(0,s.jsx)(n.code,{children:"set"})," \u65b9\u6cd5\u5167\uff0c\u900f\u904e\u5b83\u53bb\u66f4\u65b0\u72c0\u614b\u503c\uff0c"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const [state,setState] = useState()\n\nsetState((n)=>n+1) \n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4e0a\u8ff0\u7a0b\u5f0f\u78bc ",(0,s.jsx)(n.code,{children:"(n)=>n+1"})," \u5c31\u662f\u6240\u8b02\u7684 updater function\uff0c\u4e0a\u9762\u6709\u63d0\u904e state \u6578\u503c\u66f4\u65b0\uff0c\u4e00\u822c\u6703\u5728\u7576\u6b21\u6e32\u67d3\u7a0b\u5f0f\u90fd\u5b8c\u6210\u624d\u66f4\u65b0\uff0c\u5982\u679c\u6539\u7528\u9019\u500b\u65b9\u6cd5\u5247\u4e0d\u540c\uff0c\u7b2c\u4e00\u6b21\u547c\u53eb ",(0,s.jsx)(n.code,{children:"set"})," \u65b9\u6cd5\u7684\u56de\u50b3\u503c\u6703\u4f5c\u70ba parameter \u88ab\u50b3\u5165\u7b2c\u4e8c\u6b21\u547c\u53eb\u7684\uff0c\u4f9d\u5e8f\u50b3\u905e\u76f4\u5230\u6c92\u6709\u66f4\u591a ",(0,s.jsx)(n.code,{children:"set"})," \u65b9\u6cd5\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const [state,setState] = useState(0)\n\n// directly update state\nsetState(state+1)  // 0 + 1\nsetState(state+1)  // 0 + 1\nsetState(state+1)  // 0 + 1\n\n//updater function \nsetState((n)=>n+1) // 0 + 1 = 1\nsetState((n)=>n+1) // 1 + 1 = 2\nsetState((n)=>n+1) // 2 + 1 = 3\n"})}),"\n",(0,s.jsx)(n.h3,{id:"batch-update-\u6a5f\u5236",children:"batch update \u6a5f\u5236"}),"\n",(0,s.jsxs)(n.p,{children:["\u70ba\u4f55 ",(0,s.jsx)(n.strong,{children:"batch update"})," \u8981\u7279\u5225\u62c9\u51fa\u4e00\u500b\u7ae0\u7bc0\uff0c\u662f\u56e0\u70ba\u81ea\u5df1\u7406\u89e3\u5b83\u7b97\u662f\u91cd\u8981\u7684\u6027\u80fd\u7bc0\u7701\u6a5f\u5236\u3002\n",(0,s.jsx)(n.strong,{children:"\u524d\u9762\u6709\u63d0\u904e state \u6539\u8b8a\u8207\u5143\u4ef6\u7684 re-render \u606f\u606f\u76f8\u95dc"}),"\uff0c\u5047\u8a2d\u4eca\u5929\u4e8b\u4ef6\u89f8\u767c\u6642\uff0c\u57f7\u884c\u4e86\u591a\u6b21\u7684 ",(0,s.jsx)(n.code,{children:"set"})," \u65b9\u6cd5 \uff0c\u90a3\u7167\u7406\u4f86\u8aaa\u61c9\u8a72\u6703\u591a\u6b21 re-render \uff0c\u4f46\u5be6\u969b\u4e0a\u53ea\u6703\u767c\u751f\u4e00\u6b21\uff0c\u9019\u80cc\u5f8c\u5c31\u662f batch update \u6a5f\u5236\u5728\u904b\u4f5c\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const [number,setNumber] = useState(0)\n<button onClick={() => {  \n\tsetCount(1);  \n    setCount(2);  \n    setCount(3);\n}}>+3</button>\n\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u95dc\u65bc batch update \u7684\u904b\u4f5c\u539f\u7406\uff0c\u6211\u81ea\u5df1\u6703\u7528 ",(0,s.jsx)(n.a,{href:"/docs/Javascript/%5Bjs%5Deventloop",children:"Event loop"})," \u4e2d\u7684\u975e\u540c\u6b65\u6982\u5ff5\u4f86\u7406\u89e3\uff0c\u7576 ",(0,s.jsx)(n.code,{children:"set"})," \u65b9\u6cd5\u89f8\u767c\u5f8c\uff0c\u5be6\u969b\u4e0a\u4e26\u4e0d\u6703\u99ac\u4e0a\u57f7\u884c\uff0c\u800c\u662f\u5168\u90e8\u6703\u653e\u5230\u985e\u4f3c queueing \u7684\u7b49\u5f85\u5217\u88e1\u9762\uff0c\u7b49\u5168\u90e8\u5167\u5bb9\u90fd\u57f7\u884c\u5b8c\u958b\u59cb\u4e00\u6b21\u57f7\u884c\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://i.imgur.com/U2Jp5VG.png",alt:""})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["\u5716\u7247\u4f86\u6e90\uff1a",(0,s.jsx)(n.a,{href:"https://ithelp.ithome.com.tw/articles/10300091",children:"https://ithelp.ithome.com.tw/articles/10300091"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u9019\u6a23\u7684\u597d\u8655\u662f\u907f\u514d\u7121\u610f\u7fa9\u7684\u6e32\u67d3\uff0c\u9020\u6210\u591a\u9918\u7684\u6548\u80fd\u640d\u8017\uff0c\u6211\u89ba\u5f97\u5b98\u65b9\u6587\u4ef6\u7684\u6bd4\u55bb\u5f88\u50b3\u795e\uff1a"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u5047\u8a2d\u6bcf\u6b21\u72c0\u614b\u6539\u8b8a\u6703\u89f8\u767c\u6e32\u67d3\u9019\u4e8b\u4ef6\uff0c\u60f3\u50cf\u70ba\u670d\u52d9\u751f\u70ba\u5ba2\u4eba\u9ede\u9910\uff0c\u8981\u662f\u6c92\u6709 batch update \u6a5f\u5236\uff0c\u4f60\u53ef\u4ee5\u7406\u89e3\u70ba\u5ba2\u4eba\u6bcf\u8abf\u6574\u4e00\u6b21\u83dc\u8272\uff0c\u670d\u52d9\u751f\u5c31\u8981\u8dd1\u4e00\u6b21\u5eda\u623f\uff0c\u9019\u6a23\u4e0d\u662f\u5f88\u6c92\u6548\u7387\uff1f\u6709\u4e86 batch update \u6a5f\u5236\uff0c\u5c31\u50cf\u662f\u5ba2\u4eba\u78ba\u5b9a\u9019\u6b21\u8981\u9ede\u7684\u5167\u5bb9\u5f8c\uff0c\u6700\u7d42\u518d\u4e00\u6b21\u53bb\u901a\u77e5\u5eda\u623f\u4e0a\u4ec0\u9ebc\u83dc\u3002"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},5809:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/array-cba71693d635e2546ef6221b08119a68.png"},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>l});var s=t(6540);const a={},c=s.createContext(a);function r(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);