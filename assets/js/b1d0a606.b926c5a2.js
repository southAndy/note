"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[4747],{6199:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>d,toc:()=>o});var r=t(4848),i=t(8453);const s={title:"React \u5143\u4ef6\u6e32\u67d3\u751f\u547d\u9031\u671f",description:"React \u5143\u4ef6\u7684\u5b8c\u6574\u6e32\u67d3\u6a5f\u5236\uff0c\u5305\u542b Mount\u3001Update\u3001Unmount \u4e09\u500b\u751f\u547d\u9031\u671f\u7684\u8a73\u7d30\u6d41\u7a0b\uff0ctrigger phase\u3001render phase\u3001commit phase \u7684\u904b\u4f5c\u539f\u7406"},c="React - \u756b\u9762\u6e32\u67d3\u6a5f\u5236",d={id:"react/render-system",title:"React \u5143\u4ef6\u6e32\u67d3\u751f\u547d\u9031\u671f",description:"React \u5143\u4ef6\u7684\u5b8c\u6574\u6e32\u67d3\u6a5f\u5236\uff0c\u5305\u542b Mount\u3001Update\u3001Unmount \u4e09\u500b\u751f\u547d\u9031\u671f\u7684\u8a73\u7d30\u6d41\u7a0b\uff0ctrigger phase\u3001render phase\u3001commit phase \u7684\u904b\u4f5c\u539f\u7406",source:"@site/docs/react/render-system.md",sourceDirName:"react",slug:"/react/render-system",permalink:"/docs/react/render-system",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"React \u5143\u4ef6\u6e32\u67d3\u751f\u547d\u9031\u671f",description:"React \u5143\u4ef6\u7684\u5b8c\u6574\u6e32\u67d3\u6a5f\u5236\uff0c\u5305\u542b Mount\u3001Update\u3001Unmount \u4e09\u500b\u751f\u547d\u9031\u671f\u7684\u8a73\u7d30\u6d41\u7a0b\uff0ctrigger phase\u3001render phase\u3001commit phase \u7684\u904b\u4f5c\u539f\u7406"}},l={},o=[{value:"Mount",id:"mount",level:3},{value:"render phase",id:"render-phase",level:4},{value:"commit phase",id:"commit-phase",level:4},{value:"\u89f8\u767c\u526f\u4f5c\u7528\u8655\u7406",id:"\u89f8\u767c\u526f\u4f5c\u7528\u8655\u7406",level:4},{value:"Update",id:"update",level:3},{value:"render phase",id:"render-phase-1",level:4},{value:"commit phase",id:"commit-phase-1",level:4},{value:"\u6e05\u9664\u820a\u7248\u526f\u4f5c\u7528",id:"\u6e05\u9664\u820a\u7248\u526f\u4f5c\u7528",level:4},{value:"\u89f8\u767c\u526f\u4f5c\u7528",id:"\u89f8\u767c\u526f\u4f5c\u7528",level:4},{value:"Unmount",id:"unmount",level:3},{value:"render phase",id:"render-phase-2",level:4},{value:"\u6e05\u9664\u820a\u7248\u526f\u4f5c\u7528",id:"\u6e05\u9664\u820a\u7248\u526f\u4f5c\u7528-1",level:4},{value:"commit phase",id:"commit-phase-2",level:4},{value:"\u79fb\u9664 fiber node",id:"\u79fb\u9664-fiber-node",level:4},{value:"\u53c3\u8003\u8cc7\u6599",id:"\u53c3\u8003\u8cc7\u6599",level:2}];function a(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"react---\u756b\u9762\u6e32\u67d3\u6a5f\u5236",children:"React - \u756b\u9762\u6e32\u67d3\u6a5f\u5236"}),"\n",(0,r.jsxs)(n.p,{children:["React \u7684\u9801\u9762\u5340\u57df\u90fd\u662f\u7531\u8a31\u591a\u4e0d\u540c\u5143\u4ef6\u6240\u69cb\u6210\uff0c\u56e0\u6b64\u4e86\u89e3\u5143\u4ef6\u7684\u6e32\u67d3\u4e5f\u662f\u975e\u5e38\u91cd\u8981\u7684\uff0c\u5728 React \u5143\u4ef6\u6e32\u67d3\u4e3b\u8981\u6709\u4e09\u500b\u9031\u671f\uff0c\u5206\u5225\u662f ",(0,r.jsx)(n.em,{children:"mount"})," , ",(0,r.jsx)(n.em,{children:"update"}),", ",(0,r.jsx)(n.em,{children:"unmount"})," \u3002"]}),"\n",(0,r.jsx)(n.p,{children:"\u6bcf\u500b\u9031\u671f\u6703\u57f7\u884c\u7684\u67b6\u69cb\u6e32\u67d3\uff0c\u90fd\u6703\u5b8c\u6574\u7d93\u6b77\u4ee5\u4e0b\u6b65\u9a5f\uff1a"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["trigger phase\uff1a\u57f7\u884c ",(0,r.jsx)(n.em,{children:"set function"})," \u544a\u77e5 React \u756b\u9762\u8981\u91cd\u65b0\u6e32\u67d3"]}),"\n",(0,r.jsxs)(n.li,{children:["render phase\uff1aReact \u958b\u59cb\u7522\u751f\u6b64\u6b21\u756b\u9762\u7684 virtual DOM \u67b6\u69cb\uff0c\u9084\u53ef\u7d30\u5206\uff1a","\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u9996\u6b21\u89f8\u767c\uff1a\u4e0d\u6703\u6709\u6bd4\u8f03 virtual DOM \u67b6\u69cb\u6d41\u7a0b"}),"\n",(0,r.jsx)(n.li,{children:"\u66f4\u65b0\u89f8\u767c\uff1a\u6703\u6709\u6bd4\u8f03\u6d41\u7a0b"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"commit phase\uff1a\u5c07\u5dee\u7570\u90e8\u5206\u67b6\u69cb\u63d0\u4ea4\u7d66\u700f\u89bd\u5668\uff0c\u958b\u59cb\u6b63\u5f0f\u6e32\u67d3\u771f\u5be6 DOM"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",children:"const Counter = ({counter})=>{\n\tconst [counter,setCounter] = useState(0);\n\n\tconst add = ()=>{\n\t\tsetCounter((n)=>n+1)\n\t}\n\treturn (\n\t\t<div>\n\t\t\t{counter}\n\t\t\t<button onClick={add}>add</button>\n\t\t</div>\n\t)\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"mount",children:"Mount"}),"\n",(0,r.jsx)(n.h4,{id:"render-phase",children:"render phase"}),"\n",(0,r.jsxs)(n.p,{children:["\u57f7\u884c Counter \u5143\u4ef6\u7684 ",(0,r.jsx)(n.em,{children:"component function"})," \uff0c\u57f7\u884c\u5f8c\u6703\u5efa\u7acb\u5143\u4ef6\u7684 ",(0,r.jsx)(n.em,{children:"Lexical context"}),"\uff0c\u800c\u5982\u679c\u6709 ",(0,r.jsx)(n.code,{children:"state"}),", ",(0,r.jsx)(n.code,{children:"props"})," \u7b49\u8cc7\u8a0a\u7684\u9700\u6c42\uff0cReact \u6703\u5728\u80cc\u5f8c\u7522\u751f ",(0,r.jsx)(n.em,{children:"fiber node"})," \u53bb\u5132\u5b58\u8cc7\u8a0a\uff0c\u6700\u7d42\u5c31\u662f\u7522\u751f\u4e26\u56de\u50b3 React element \u67b6\u69cb\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",children:"Counter() //\u958b\u59cb\u6e32\u67d3\u9019\u500b\u5143\u4ef6\n\nconst Counter = ({counter})=>{\n\t// \u7522\u751f\u8b8a\u6578\u3001\u51fd\u5f0f\n\tconst [counter,setCounter] = useState(0);\n\n\tuseEffect(()=>{\n\t\tconsole.log('render')\n\t\treturn ()=>{}\n\t},[])\n\n\t// \u7522\u751f\u51fd\u5f0f\n\tconst add = ()=>{\n\t\tsetCounter((n)=>n+1)\n\t}\n\t// \u56de\u50b3 React elements\n\treturn (\n\t\t<div>\n\t\t\t{counter}\n\t\t\t<button onClick={add}>add</button>\n\t\t</div>\n\t)\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5982\u679c\u6c92\u6709\u66f4\u591a\u5143\u4ef6\u5167\u5bb9\u8981\u9032\u884c\u6e32\u67d3\uff0c\u5c31\u6703\u5c07\u8a72 React element \u67b6\u69cb\u63d0\u4ea4\u3002"}),"\n",(0,r.jsx)(n.h4,{id:"commit-phase",children:"commit phase"}),"\n",(0,r.jsx)(n.p,{children:"\u700f\u89bd\u5668\u6703\u4f9d\u7167\u9019\u500b\u67b6\u69cb\u53bb\u6e32\u67d3\u771f\u5be6\u7684 DOM \u67b6\u69cb"}),"\n",(0,r.jsx)(n.h4,{id:"\u89f8\u767c\u526f\u4f5c\u7528\u8655\u7406",children:"\u89f8\u767c\u526f\u4f5c\u7528\u8655\u7406"}),"\n",(0,r.jsxs)(n.p,{children:["\u5b8c\u6210\u771f\u5be6 DOM \u67b6\u69cb\u6e32\u67d3\u5f8c\u89f8\u767c ",(0,r.jsx)(n.em,{children:"effect function"})," \u57f7\u884c\u5143\u4ef6\u6240\u9700\u7684\u526f\u4f5c\u7528\u3002"]}),"\n",(0,r.jsx)(n.h3,{id:"update",children:"Update"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728 React \u9019\u500b\u6d41\u7a0b\u53c8\u88ab\u7a31\u70ba ",(0,r.jsx)(n.em,{children:"Reconciliation"}),"\uff0c\u7576\u5143\u4ef6\u5167\u7684 set function \u88ab\u89f8\u767c\uff0c\u4e14\u6bd4\u5c0d\u5143\u4ef6\u65b0\u820a\u72c0\u614b\u767c\u73fe\u78ba\u5be6\u6709\u8b8a\u5316\u5f8c\u6703\u9032\u884c\u3002"]}),"\n",(0,r.jsx)(n.h4,{id:"render-phase-1",children:"render phase"}),"\n",(0,r.jsxs)(n.p,{children:["\u5df2\u77e5React \u63a1\u53d6 ",(0,r.jsx)(n.em,{children:"\u4e00\u5f8b\u91cd\u7e6a"})," \u7684\u6e32\u67d3\u7b56\u7565\uff0c\u6240\u4ee5\u6703\u5148\u6839\u64da\u65b0\u7684 state \u7522\u751f\u65b0\u7684 virtual DOM \u67b6\u69cb\u53bb\u8ddf\u820a\u7248\u7684\u9032\u884c\u6bd4\u8f03\uff0c\u6bd4\u8f03\u7684\u65b9\u5f0f\u5c31\u662f ",(0,r.jsx)(n.strong,{children:"\u63a1\u7528 Diff \u6f14\u7b97\u6cd5\u9032\u884c\u65b0\u820a\u67b6\u69cb\u7684\u6bd4\u8f03"}),"\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"\u6bd4\u8f03\u6703\u5f9e\u6839\u5143\u7d20\u958b\u59cb\u6bd4\u5c0d\uff0c\u5982\u679c root element \u7684\u5143\u7d20\u5df2\u4e0d\u540c\uff0c\u5c31\u6703\u8df3\u904e\u5f8c\u7e8c\u6bd4\u8f03\u6d41\u7a0b\uff0c\u76f4\u63a5\u5c07\u5168\u65b0\u7684 virtual DOM \u63d0\u4ea4\u7d66\u700f\u89bd\u5668\u4f7f\u7528\u3002"}),"\n",(0,r.jsxs)(n.p,{children:["\u5047\u8a2d\u6839\u90e8\u5143\u7d20\u5f9e ",(0,r.jsx)(n.code,{children:"<div>"})," \u6539\u8b8a\u70ba ",(0,r.jsx)(n.code,{children:"<section>"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",children:"// \u820a\u7248\u67b6\u69cb\nconst Page = ({})=>{\n\treturn (\n\t\t\n\t\t<div>\n\t\t\t<ChildComponent/>\n\t\t</div>\n\t)\n}\n\n// \u65b0\u7248\u67b6\u69cb\nconst Page = ({})=>{\n\treturn (\n\t\t\n\t\t<section>\n\t\t\t<ChildComponent/>\n\t\t</section>\n\t)\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"commit-phase-1",children:"commit phase"}),"\n",(0,r.jsx)(n.p,{children:"\u700f\u89bd\u5668\u5c07\u63d0\u4ea4\u7684\u67b6\u69cb\u6e32\u67d3\u70ba\u771f\u5be6 DOM \u67b6\u69cb"}),"\n",(0,r.jsx)(n.h4,{id:"\u6e05\u9664\u820a\u7248\u526f\u4f5c\u7528",children:"\u6e05\u9664\u820a\u7248\u526f\u4f5c\u7528"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u89f8\u767c effect function \u524d\uff0c\u82e5\u662f\u6709 clean function \u5b58\u5728\uff0c",(0,r.jsx)(n.strong,{children:"\u5728\u6bcf\u6b21 update \u9031\u671f\u90fd\u6703\u5148\u57f7\u884c clean function \u6e05\u9664\u524d\u4e00\u6b21\u5143\u4ef6\u6240\u907a\u7559\u7684\u526f\u4f5c\u7528\u3002"})]}),"\n",(0,r.jsx)(n.h4,{id:"\u89f8\u767c\u526f\u4f5c\u7528",children:"\u89f8\u767c\u526f\u4f5c\u7528"}),"\n",(0,r.jsx)(n.p,{children:"\u91cd\u65b0\u547c\u53eb effect function \u3002"}),"\n",(0,r.jsx)(n.h3,{id:"unmount",children:"Unmount"}),"\n",(0,r.jsx)(n.h4,{id:"render-phase-2",children:"render phase"}),"\n",(0,r.jsx)(n.p,{children:"\u505a\u985e\u4f3c update \u9031\u671f\u6642\u6703\u9032\u884c\u7684 virtual DOM \u6bd4\u8f03\u5f8c\uff0c\u767c\u73fe\u65b0\u7684\u67b6\u69cb\u4e0b\u5143\u4ef6\u5df2\u4e0d\u5b58\u5728\uff0c\u63a5\u8457\u63d0\u4ea4\u5dee\u7570\u3002"}),"\n",(0,r.jsx)(n.h4,{id:"\u6e05\u9664\u820a\u7248\u526f\u4f5c\u7528-1",children:"\u6e05\u9664\u820a\u7248\u526f\u4f5c\u7528"}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u57f7\u884c\u5be6\u969b\u7684 DOM \u67b6\u69cb\u66f4\u65b0\u524d\uff0c\u6703\u5148\u6e05\u9664\u820a\u7248\u7684\u526f\u4f5c\u7528"}),"\n",(0,r.jsx)(n.h4,{id:"commit-phase-2",children:"commit phase"}),"\n",(0,r.jsx)(n.p,{children:"\u6839\u64da\u5dee\u7570\u9032\u884c\u5be6\u969b\u7684 DOM \u67b6\u69cb\u6e32\u67d3"}),"\n",(0,r.jsx)(n.h4,{id:"\u79fb\u9664-fiber-node",children:"\u79fb\u9664 fiber node"}),"\n",(0,r.jsxs)(n.p,{children:["\u79fb\u9664\u9019\u500b\u5143\u4ef6\u6240\u9700\u7684 ",(0,r.jsx)(n.code,{children:"state"})," , ",(0,r.jsx)(n.code,{children:"props"})," \u7b49\u8cc7\u8a0a\u7684\u5132\u5b58\u3002"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\u53c3\u8003\u8cc7\u6599",children:"\u53c3\u8003\u8cc7\u6599"}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://zh-hant.legacy.reactjs.org/docs/reconciliation.html",children:"Reconciliation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://ithelp.ithome.com.tw/articles/10300256",children:"## \u5f9ejQuery\u5230VirtualDOM\u4f86\u6dfa\u8ac7\u4ec0\u9ebc\u662fstate\u2014useState\u5b8c\u6574\u7bc4\u4f8b\u8207\u4ecb\u7d39"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://medium.com/swf-lab/react-%E6%B8%B2%E6%9F%93%E6%A9%9F%E5%88%B6-virtual-dom-%E8%88%87-diffing-%E6%BC%94%E7%AE%97%E6%B3%95-fcf515ccbc59",children:"# React \u6e32\u67d3\u6a5f\u5236 \u2014 \u2014 Virtual DOM \u8207 Diffing \u6f14\u7b97\u6cd5"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://www.geeksforgeeks.org/what-is-diffing-algorithm/",children:"# What is Diffing Algorithm ?"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>d});var r=t(6540);const i={},s=r.createContext(i);function c(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);