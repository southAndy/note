"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[442],{3673:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>i});var s=n(4848),c=n(8453);const r={},l=void 0,a={id:"React/useState",title:"useState",description:"\u70ba\u4f55\u9700\u8981 state",source:"@site/docs/React/useState.md",sourceDirName:"React",slug:"/React/useState",permalink:"/docs/React/useState",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"techNoteSidebar",previous:{title:"Render and Commit",permalink:"/docs/React/render"},next:{title:"[Vue] keywords",permalink:"/docs/Vue/Keywords"}},d={},i=[{value:"\u70ba\u4f55\u9700\u8981 state",id:"\u70ba\u4f55\u9700\u8981-state",level:2},{value:"\u4f7f\u7528\u9650\u5236",id:"\u4f7f\u7528\u9650\u5236",level:2},{value:"\u56de\u50b3\u503c",id:"\u56de\u50b3\u503c",level:2},{value:"\u5982\u4f55\u66f4\u65b0 state \uff1f",id:"\u5982\u4f55\u66f4\u65b0-state-",level:2},{value:"value type",id:"value-type",level:3},{value:"reference type",id:"reference-type",level:3},{value:"\u96e2\u6563\u8a9e\u6cd5",id:"\u96e2\u6563\u8a9e\u6cd5",level:4},{value:"\u5b58\u5165\u5168\u65b0\u7269\u4ef6",id:"\u5b58\u5165\u5168\u65b0\u7269\u4ef6",level:4},{value:"batch update",id:"batch-update",level:2}];function o(e){const t={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"#react"}),"\n",(0,s.jsx)(t.h2,{id:"\u70ba\u4f55\u9700\u8981-state",children:"\u70ba\u4f55\u9700\u8981 state"}),"\n",(0,s.jsxs)(t.p,{children:["\u4eca\u5929\u6211\u5011\u5148\u4f7f\u7528\u4e00\u500b\u666e\u901a\u7684 Javascript \u8b8a\u6578 ",(0,s.jsx)(t.code,{children:"number"}),"\uff0c\u7576\u9ede\u64ca\u756b\u9762\u4e0a\u7684\u6309\u9215\u6642\uff0c\u89f8\u767c\u4e8b\u4ef6\u6642\u6703\u66f4\u65b0\u5b83\u7684\u503c\uff1a"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"const number = 0;\n\nconst addNumber = ()=>{\n    number = number+1\n}\n<p> current {number} </p>\n<button onClick={addNumber}></button>\n"})}),"\n",(0,s.jsxs)(t.p,{children:["\u5982\u679c\u6211\u5011\u5e0c\u671b\u770b\u5230 ",(0,s.jsx)(t.code,{children:"number"})," \u6578\u503c\u6539\u8b8a\u986f\u793a\u5728\u756b\u9762\uff0c\u6703\u9700\u8981\u91cd\u65b0\u6e32\u67d3\u756b\u9762\uff0c\u4f46\u4f60\u6703\u767c\u73fe\u9019\u500b\u503c\u7684\u6539\u8b8a\u7121\u6cd5\u88ab\u4fdd\u5b58\uff0c\u56e0\u70ba\u6bcf\u6b21\u91cd\u65b0\u6e32\u67d3\u9801\u9762\u6642\u90fd\u6703\u91cd\u65b0\u70ba ",(0,s.jsx)(t.code,{children:"number"})," \u8ce6\u503c\u3002 react \u7684 ",(0,s.jsx)(t.code,{children:"state"})," \u9664\u4e86\u53ef\u4ee5\u89e3\u6c7a",(0,s.jsx)(t.strong,{children:"\u6578\u503c\u6539\u8b8a\u7121\u6cd5\u5728\u9801\u9762\u6e32\u67d3\u9593\u88ab\u4fdd\u5b58\u7684\u554f\u984c"}),"\u5916\uff0c\u4e5f",(0,s.jsxs)(t.strong,{children:["\u5c07 ",(0,s.jsx)(t.code,{children:"state"})," \u6539\u8b8a\u8207\u9801\u9762\u6e32\u67d3\u9032\u884c\u639b\u9264"]}),"\uff0c\u8b93\u4f7f\u7528\u8005\u66f4\u65b9\u4fbf\u9032\u884c\u958b\u767c\u3002"]}),"\n",(0,s.jsx)(t.h2,{id:"\u4f7f\u7528\u9650\u5236",children:"\u4f7f\u7528\u9650\u5236"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"\u53ea\u80fd\u5728 function component \u4f7f\u7528 \uff0cclass component \u4e0d\u80fd"}),"\n",(0,s.jsxs)(t.li,{children:["\u53ea\u80fd\u5728 function component \u5167\u7684 top-level \u547c\u53eb\uff0c\u4e0d\u53ef\u5728 ",(0,s.jsx)(t.code,{children:"block scoped"})," \u547c\u53eb"]}),"\n",(0,s.jsxs)(t.li,{children:["\u66f4\u65b0 state \u9700\u9075\u5b88 ",(0,s.jsx)(t.strong,{children:"immutable"})," \u539f\u5247"]}),"\n"]}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:["\u6240\u8b02\u7684 block scoped \u5305\u542b\uff1a ",(0,s.jsx)(t.code,{children:"if(){}"})," , ",(0,s.jsx)(t.code,{children:"for(){}"}),", ",(0,s.jsx)(t.code,{children:"setTimeout(()=>{},1000)"})]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"import {useState} from 'react'\n\nfunction LimitShow(){\n\tif(true) { useState(1) } // x\n\tfor(xx) { useState(1) } // x\n\tfunction(){useState()} // x\n}\n"})}),"\n",(0,s.jsx)(t.h2,{id:"\u56de\u50b3\u503c",children:"\u56de\u50b3\u503c"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"useState"}),"  \u6703\u56de\u50b3\u4e00\u500b\u9663\u5217 \uff0cindex: 0 \u662f\u521d\u59cb\u7684 ",(0,s.jsx)(t.code,{children:"state"})," \uff0cindex: 1 \u5247\u662f\u66f4\u65b0 ",(0,s.jsx)(t.code,{children:"state"})," \u7684\u51fd\u5f0f\u3002"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"function LimitShow(){\n\tconst state = useState(1);\n\tstate = [1,handlerState()]\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:["\u6240\u4ee5\u4e00\u822c\u4f7f\u7528\u4e0a\u6703\u642d\u914d\u89e3\u69cb\u8ce6\u503c\u5c07 ",(0,s.jsx)(t.strong,{children:"\u5132\u5b58\u72c0\u614b\u8b8a\u6578"})," \u8ddf ",(0,s.jsx)(t.strong,{children:"\u8655\u7406\u72c0\u614b\u8b8a\u6578\u51fd\u5f0f"})," \u89e3\u69cb\uff0c\u65b9\u4fbf\u5404\u5225\u4f7f\u7528\u3002"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"const [state,setState] = useState(1);\n"})}),"\n",(0,s.jsx)(t.h2,{id:"\u5982\u4f55\u66f4\u65b0-state-",children:"\u5982\u4f55\u66f4\u65b0 state \uff1f"}),"\n",(0,s.jsxs)(t.p,{children:["\u6211\u5011\u77e5\u9053\u5728 Javascript \u5167\u8b8a\u6578\u5206\u70ba ",(0,s.jsx)(t.strong,{children:"call by value"})," \u8207 ",(0,s.jsx)(t.strong,{children:"call by reference"})," \u5169\u7a2e\u985e\u578b\uff0c\u70ba\u4e86\u9075\u5b88 immutable \u539f\u5247\uff0c\u5728 react \u66f4\u65b0\u9019\u5169\u7a2e\u985e\u578b\u8cc7\u6599\u7684\u65b9\u6cd5\u4e26\u4e0d\u76f8\u540c\uff1a"]}),"\n",(0,s.jsx)(t.h3,{id:"value-type",children:"value type"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"const [state,setState] = useState(1)\n\n//\u66f4\u65b0\u65b9\u5f0f\nsetState(val)\n"})}),"\n",(0,s.jsx)(t.h3,{id:"reference-type",children:"reference type"}),"\n",(0,s.jsxs)(t.p,{children:["\u76f4\u63a5\u66f4\u65b0 ",(0,s.jsx)(t.strong,{children:"reference type"})," \u7684\u8cc7\u6599\u5167\u5bb9\uff08\u5982\u4e0b\u5716\uff09\uff0c\u5728 react \u7121\u6cd5\u88ab\u5075\u6e2c\u5230 ",(0,s.jsx)(t.code,{children:"state"})," \u6709\u7522\u751f\u6539\u8b8a\uff0c\u756b\u9762\u66f4\u65b0\u6703\u5931\u6548\u3002"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"const [test,setTest] = useState({name:'1'})\n// x: \u76f4\u63a5\u66f4\u65b0\u7269\u4ef6 key \u503c\nsetState(()=>test.name=\"2\")\n"})}),"\n",(0,s.jsxs)(t.p,{children:["\u8981\u4fdd\u6301 state \u503c\u7dad\u6301 ",(0,s.jsx)(t.code,{children:"immutable"}),"\u7684\u60c5\u5f62\u53bb\u66f4\u65b0\uff0c\u6709\u4ee5\u4e0b\u65b9\u6cd5\uff1a"]}),"\n",(0,s.jsx)(t.h4,{id:"\u96e2\u6563\u8a9e\u6cd5",children:"\u96e2\u6563\u8a9e\u6cd5"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",children:"const [state,setState] = useState({x:1,y:2})\n\nsetState({...state,\u8981\u66f4\u65b0\u90e8\u5206\u7684\u503c})\n"})}),"\n",(0,s.jsx)(t.h4,{id:"\u5b58\u5165\u5168\u65b0\u7269\u4ef6",children:"\u5b58\u5165\u5168\u65b0\u7269\u4ef6"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",children:"const [state,setState] = useState({x:1,y:2})\nsetState({x:2,y:3})\n"})}),"\n",(0,s.jsx)(t.h2,{id:"batch-update",children:"batch update"}),"\n",(0,s.jsxs)(t.p,{children:["\u70ba\u4f55 ",(0,s.jsx)(t.strong,{children:"batch update"})," \u8981\u7279\u5225\u62c9\u51fa\u4e00\u500b\u7ae0\u7bc0\uff0c\u662f\u56e0\u70ba\u5b83\u7b97\u662f\u91cd\u8981\u7684\u6027\u80fd\u7bc0\u7701\u6a5f\u5236\u3002\n",(0,s.jsx)(t.strong,{children:"\u524d\u9762\u6709\u63d0\u904e state \u6539\u8b8a\u8207\u5143\u4ef6\u7684 re-render \u606f\u606f\u76f8\u95dc"}),"\uff0c\u5047\u8a2d\u4eca\u5929\u4e8b\u4ef6\u89f8\u767c\u6642\uff0c\u57f7\u884c\u4e86\u591a\u6b21\u7684 ",(0,s.jsx)(t.code,{children:"set"})," \u65b9\u6cd5 \uff0c\u90a3\u7167\u7406\u4f86\u8aaa\u61c9\u8a72\u6703\u591a\u6b21 re-render \uff0c\u4f46\u5be6\u969b\u4e0a\u53ea\u6703\u767c\u751f\u4e00\u6b21\uff0c\u9019\u80cc\u5f8c\u5c31\u662f batch update \u6a5f\u5236\u5728\u904b\u4f5c\u3002"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",children:"const [number,setNumber] = useState(0)\n<button onClick={() => {  \n\tsetCount(1);  \n    setCount(2);  \n    setCount(3);\n}}>+3</button>\n\n"})}),"\n",(0,s.jsxs)(t.p,{children:["\u95dc\u65bc batch update \u7684\u904b\u4f5c\uff0c\u6211\u81ea\u5df1\u6703\u7528 ",(0,s.jsx)(t.a,{href:"/docs/Javascript/%5Bjs%5Deventloop",children:"Event loop"})," \u7684\u6982\u5ff5\u4f86\u7406\u89e3\u9019\u4ef6\u4e8b\uff0c\u7576 ",(0,s.jsx)(t.code,{children:"set"})," \u65b9\u6cd5\u89f8\u767c\u5f8c\uff0c\u5be6\u969b\u4e0a\u4e26\u4e0d\u6703\u99ac\u4e0a\u57f7\u884c\uff0c\u800c\u662f\u5168\u90e8\u6703\u653e\u5230\u985e\u4f3c callbackque \u7684\u7b49\u5f85\u5217\u88e1\u9762\uff0c\u7b49\u5168\u90e8\u5167\u5bb9\u90fd\u57f7\u884c\u5b8c\u958b\u59cb\u4e00\u6b21\u57f7\u884c\u3002"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:"https://i.imgur.com/U2Jp5VG.png",alt:""})}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:["\u5716\u7247\u4f86\u6e90\uff1a",(0,s.jsx)(t.a,{href:"https://ithelp.ithome.com.tw/articles/10300091",children:"https://ithelp.ithome.com.tw/articles/10300091"})]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>a});var s=n(6540);const c={},r=s.createContext(c);function l(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:l(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);